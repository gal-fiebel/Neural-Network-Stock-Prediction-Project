# Neural-Network-Stock-Prediction-Project
This is a personal project of mine which I began with the intention of practicing implementing a research paper, using Neural Networks and implementing a ML/Data Science project.
My project is based on the following research paper: https://www.researchgate.net/publication/319343084_Algorithmic_Trading_Using_Deep_Neural_Networks_on_High_Frequency_Data.
The main purpose of my project is using a simple Neural Network architecture in order to predict the average price of the IBM stock for the next trading day. Below are the steps I took in this project.

### First Step
My initial objective for this project was implementing the research paper listed above. In order to accomplish this, I needed historical tick by tick trading data (meaning data that is given in milliseconds). However, free data of this sort is not easy to come by. Also, I realized that the algo-trading method in the paper is not suited for my trading needs and capabilities (if my project would yield promising results I would need a strategy that would be feasible for me to apply). For these two reasons I decided to implement the above paper, but to change the minute-by-minute strategy in the paper to a day-by-day strategy. This I accomplished by regarding the inter-minute calculations (linear regression slope for example) as inter-day calculations, meaning the calculations in the paper applied on milliseconds I applied on minutes, thus effectively making minutes into days.
Aside from these changes I performed an almost straight forward implementation of the paper as can be seen in the [two_week_simulation_testing.ipynb](two_week_simulation_testing.ipynb) file. Another change I made was using IBM stock data rather than APPLE stock data, only for the fact that this was the only stock I found free data for. The training data I used was [training data](http://api.kibot.com/?action=history&symbol=IBM&interval=1&unadjusted=1&bp=1&user=guest), this is minute by minute trading data of IBM stock from 1998 until January 29,2021. The test data I used was from the following website [test_data](https://www.alphavantage.co/documentation/), this is minute by minute trading data of IBM stock from Febraury 1, 2021 until February 12, 2021.
The best result achieved was a profit of 9.57$ for trading 1 stock, this comes out to roughly a profit of 0.08$ for a dollars worth of stock in two weeks.

### Second Step
After finishing the previous step I felt like trying a different way to predict the next day trading data that would allow for more frequent updates by adding the previous day's data and retraining the network and predicting the next trading day. This test can be seen in the [day_by_day_simulation_test.ipynb](day_by_day_simulation_test.ipynb) file.
In this file only the parameter range for the selected model can be seen since I split the parameter selection process between 6 different Google Colab accounts in order to use their GPU for the training. The best result achieved was a profit of 10.13$ for trading 1 stock, this comes out to roughly a profit of 0.09$ for a dollars worth of stock in two weeks.
The model that I selected was not the most profitable model. This was the most profitable model had low scores (MSE, MAPE and Directional Accuracy). The model I selected is a model with window_size of 2 (meaning data from two days back) and 10 hidden layers. This model was very profitable and had great scores as well.

### Final Step
After selecting my model I decided to write a python program for updating daily predictions, this program can be seen in the [make_prediction.py](make_prediction.py) file.
In this program the user is asked if this is the first ever run of this stock, the last trading day's day, month and year, the stock name and finally an Alpha Vantage API key. If it is the first ever run for the stock then the program performs the first training and saves the needed data in the format of numpy arrays (.npy files) and predicts the next trading day's average price. If it is not the first ever run, then the program reads the last trading day's data from Alpha Vantage, using the API key entered and updates the numpy arrays consisting of the data for training and predicting, and then retrains the model and predicts the next trading day's average price.

### Simulation and Results
I performed a simulation for 20 trading days (1 month) in which I predicted the next trading day's average price using the python program from the previous step, then decided to buy or sell based on the trading strategy that was used in the research paper and performed the trading by using the free trial of the Interactive Brokers Trading WorkStation platform for simulated trading.
#### The results are as followed: Buying and Selling the equivalent of a dollar's worth in shares the strategy accunulated approximately 0.075$ in 20 trading days.
